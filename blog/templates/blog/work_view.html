{% extends "base.html" %}

{% block title %}{{ work.title }} {% endblock %}

{% block content %}

<div class="row">
	<div class="panel">
		<div class="row">
			<div class="large-12 columns">

				<h2>{{ work.title }}</h2>

			</div>
			<div class="large-6 columns">

				<h5>ARTIST:</h5>
				<div class="large-12 columns">
					<p>{{work.creator.name}}</p>
				</div>

				<h5>RELEASED:</h5>
				<div class="large-12 columns">
					<p>{{work.created}}</p>
				</div>

				<h5>CITY:</h5>
				<div class="large-12 columns">
					<p>{{work.city}}</p>
				</div>

			</div>
			<div class="large-6 columns">

				<h5>CATEGORY:</h5>
				<div class="large-12 columns">
					<p>{{work.work_category}}</p>
				</div>

				<h5>STYLES & GENRES:</h5>
				<div class="large-12 columns">
					<p>
						{% for style in work.styles.all %}
							
							{{ style }}, 
		
						{% endfor %}
					</p>
				</div>

				{% if has_tracklist %}

				<h5>TRACKLIST:</h5>
				<div class="large-12 columns">
					<p>
						<ul class="wc_list">
						{% for track in work.tracklist.all %}
							<li>
								<b>{{ track.position }}.</b> {{ track.title }} [{{ track.duration }}]
							</li>
						{% endfor %}
						</ul>
					</p>
				</div>

				{% endif %}

				<h5>CONTRIBUTORS:</h5>
				<div class="large-12 columns">
					<p>
						{% for contributor in work.contributors.all %}
							
							<p>
								<b>NAME:</b> {{ contributor.contributing_artist.name }} <br>
								<b>ROLE:</b> {{ contributor.role }}
							</p>
							<br>
		
						{% endfor %}
					</p>
				</div>

			</div>
			<div class="large-12 columns">

				<h5>WEBSITE:</h5>
				<div class="large-12 columns">
					<p><a href="{{work.website.link}}">{{work.website.name}}</a></p>
				</div>
			
			</div>
			<div class="large-12 columns">

				<h5>DESCRIPTION:</h5>
				<div class="large-12 columns">
					<p>
						<br>
						{{ work.description }}
						<br>
					</p>
				</div>

			</div>

		</div>
	</div>

	<div class="panel wc_control">
		<div class="row">
			<div class="large-12 columns">
				<h3>Controls</h3>
			</div>
			<div class="large-4 medium-4 columns">

				<form method="post" action="/wc_admin/write_review/">
					{% csrf_token %}
					<input type="hidden" name="work_id" value="{{ work.id }}">
					<input type="submit" class="button small" value="Write Article about this Work">

				</form>

				<a href="" class="button small" data-reveal-id="add_tracklist_modal">Add Tracklist</a>
			</div>
			<div class="large-8 medium-8 columns">
				<h5>Add Contributor</h5>
				<div class="large-6 columns">
					
					<p class="justify">
						<i>Remember: A "contributor" is stored as an Artist, so the contributing Artist needs to already be in the database before you can add them to this list.</i>
					</p>
					<form method="post" action="/wc_admin/add_contributor/">
						{% csrf_token %}
						<label for="number_of_contributors">Type name... are they here already?
							<input id="artists" name="contributor_name" placeholder="Type their name here" required>
						</label>
						<br>
						<label for="role">What Role did they play in this work of art?
							<input id="role" name="role" placeholder="Role" required>
						</label>
						<input type="hidden" name="work_id" value="{{ work.id }}">
						<br>
						<input type="submit" class="button small" value="ADD">
					</form>
				</div>

				<div class="large-6 columns">
					<p class="justify">
						If the contributing Artist is not already in the database, you should search/browse for them and probably add them yourself. Then you can come back here and add them to the list of contributing Artists.
					</p>

					<div class="large-6 medium-6 columns">
						<a href="/indie_db/browse_artists" class="button small">BROWSE ARTISTS</a>
					</div>
					<div class="large-6 medium-6 columns">
						<a href="/wc_admin/write_new_artist" class="button small">ADD CONTRIBUTING ARTIST TO DB</a>
					</div>
					
			
				</div>

			</div>
		</div>
	</div>

</div>

<div class="row">
	<div class="panel">
		<div class="row">
			<div class="large-12 columns">
				<h3>{{ articles.count }} Articles about {{ work }}</h3>
			</div>
				{% for article in articles %}
					<div class="large-4 medium-6 columns">
						<a href="/indie_db/view_article/?id={{ article.id }}">
								<div class="sub_panel link_panel">
									<h5>{{ article.title }}</h5>
									<p>By {{ article.author }}
										<br>
										{{ article.date_created }}
										<br>
										Category: {{ article.category }}
									</p>
								</div>
							</a>
					</div>
				{% endfor %}
		</div>

	</div>
</div>

<!-- JQuery for the autocomplete text thing -->

  <script>
  $(function() {
    var availableArtists = [
    	{% for artist in all_artists %}
    		"{{ artist.name }}",
    	{% endfor %}
    ];
    $( "#artists" ).autocomplete({
      source: availableArtists
    });
  });
  </script>

						<!-- MODALS -->


<div id="add_tracklist_modal" class="reveal-modal" data-reveal aria-labelledby="modalTitle" aria-hidden="true" role="dialog">
  <h2 id="modalTitle">Add Track List to this Work</h2>
  <p class="lead">How many tracks will you add?</p>

	<div class="large-12 columns">
		<p class="justify">
			<form method="post" action="/wc_admin/add_tracklist/">
				{% csrf_token %}
				<input type="number" name="number_of_tracks" id="number_of_tracks" placeholder="How Many?" required />
				<input type="hidden" name="work_id" id="work_id" value="{{ work.id }}" />
				<input type="submit" class="button small" value="PROCEED" />
			</form>
			
		</p>
	</div>

  <a class="close-reveal-modal" aria-label="Close">&#215;</a>
</div>


						<!-- END of MODALS -->


{% endblock %}